% !TeX root = ./explain.tex
% This file is not intended to contain any user-adjustable parameters.

\begin{document}

\begin{tikzpicture}[remember picture,overlay]

  % Add watermark
  \node [font=\ttfamily\tiny,color=black!20]
  at ($(current page text area.north) - (0mm,0.5ex)$) {
    \href{https://github.com/maverickwoo/paperpad-templates}{\number\year-\number\month-\number\day}
  };
  \node [font=\ttfamily\tiny,color=black!20]
  at ($(current page text area.south) + (0mm,0.5ex)$) {
    \href{https://github.com/maverickwoo/paperpad-templates}{\pdftitle}
  };

  % Compute origin coordinate
  \pgfmathsetlengthmacro{\totalwidth}{\textwidth}
  \pgfmathsetlengthmacro{\marginx}{(\paperwidth-\totalwidth)/2}
  \pgfmathsetlengthmacro{\totalheight}{\ny*\sylen+(\ny-1)*\sysep+\syoff}
  \pgfmathsetlengthmacro{\marginy}{(\paperheight-\totalheight)/2}
  \coordinate (origin) at ($(current page.south west) + (\marginx,\marginy)$);

  % Print y-stamps from top to bottom
  \foreach \iy in {\ny,...,1}
    {
      % depth of current ascender for dash phase computations
      \pgfmathsetlengthmacro{\depthy}{(\ny-\iy)*(\sylen+\sysep)}
      \pgfmathsetlengthmacro{\deltay}{(\iy-  1)*(\sylen+\sysep)}
      \draw ($(origin)+(0,\deltay)$) pic {ystamp};
    }

  % Clip slanted guides at horizontal margins
  \clip ($(origin)-(0,\marginy)$)
  rectangle ($(origin)+(0,\marginy)+(\totalwidth,\totalheight)$);

  % Print x-stamps from left to right
  \foreach \ix in {1,...,\nx}
    {
      \pgfmathsetlengthmacro{\deltax}{(\ix-1)*\sxsep}
      \draw ($(origin)+(\deltax,\totalheight)$) pic {xstamp};
    }

\end{tikzpicture}

\end{document}
