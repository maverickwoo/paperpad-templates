% !TeX root = ./explain.tex

% This file does not contain any user-adjustable parameter.

\begin{document}

\begin{tikzpicture}[remember picture,overlay]

  % Add watermark
  \def\repourl{https://github.com/maverickwoo/paperpad-templates}
  \draw [font=\ttfamily\tiny,color=black!20]
  node at ($(current page text area.north)-(0mm,0.5ex)$) {
    \href{\repourl}{\number\year-\number\month-\number\day}}
  node at ($(current page text area.south)+(0mm,0.5ex)$) {
    \href{\repourl}{\pdftitle}};

  % Compute origin coordinate
  \pgfmathsetlengthmacro{\totalwidth}{\textwidth}
  \pgfmathsetlengthmacro{\marginx}{(\paperwidth-\totalwidth)/2}
  \pgfmathsetlengthmacro{\totalheight}{\ny*\sylen+(\ny-1)*\sysep+\syoff}
  \pgfmathsetlengthmacro{\marginy}{(\paperheight-\totalheight)/2}
  \coordinate (origin) at ($(current page.south west)+(\marginx,\marginy)$);

  \begin{scope}[shift=(origin)]

    % Print y-stamps from top to bottom
    \foreach \iy in {\ny,...,1}
      {
        % \depthy is needed for dash phase computations in ystamp
        \pgfmathsetlengthmacro{\depthy}{(\ny-\iy)*(\sylen+\sysep)}
        \pgfmathsetlengthmacro{\deltay}{(\iy-  1)*(\sylen+\sysep)}
        \draw (0,\deltay) pic {ystamp};
      }

    % Clip slant guidelines at horizontal margins
    \clip     (          0,            -\marginy)
    rectangle (\totalwidth,\totalheight+\marginy);

    % Print x-stamps from left to right
    \foreach \ix in {1,...,\nx}
      {
        \pgfmathsetlengthmacro{\deltax}{(\ix-1)*\sxsep}
        \draw (\deltax,\totalheight) pic {xstamp};
      }

  \end{scope}

\end{tikzpicture}

\end{document}
